<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Let's Defend - RanDev | MMOX Blog</title>
<meta name=keywords content="Lets defend,Writeups,Digital Forensics,Memory,Ransomware"><meta name=description content="Digital Forensic Memory Dump challenge Writeup "><meta name=author content="MMOX "><link rel=canonical href=http://localhost:1313/posts/writeups/ran-dev/><meta name=google-site-verification content="G-PK6NYWT73S"><meta name=msvalidate.01 content="DBD2C24F1154E160699876B8EB3374F0"><link crossorigin=anonymous href=/assets/css/stylesheet.5d45b8bd1a3cf526e72959d51f1bdc688d8e97fa0df2a697a93df6bdc746feb4.css integrity="sha256-XUW4vRo89SbnKVnVHxvcaI2Ol/oN8qaXqT32vcdG/rQ=" rel="preload stylesheet" as=style><noscript><link crossorigin=anonymous href=/css/includes/noscript.30127fa68e36d08f5dd7f9d4e717dac42e729b844672afd0fbcacb0d9e508595.css integrity="sha256-MBJ/po420I9d1/nU5xfaxC5ym4RGcq/Q+8rLDZ5QhZU=" rel="preload stylesheet" as=style></noscript><link rel=icon href=http://localhost:1313/img/Favicon.webp><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/img/Favicon.webp><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/img/Favicon.webp><link rel=apple-touch-icon href=http://localhost:1313/img/Favicon.webp><link rel=mask-icon href=http://localhost:1313/img/Favicon.webp><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/writeups/ran-dev/><script async src="https://www.googletagmanager.com/gtag/js?id=G-PK6NYWT73S"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PK6NYWT73S")}</script><meta property="og:title" content="Let's Defend - RanDev"><meta property="og:description" content="Digital Forensic Memory Dump challenge Writeup "><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/writeups/ran-dev/"><meta property="og:image" content="http://localhost:1313/img/profile.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-06T00:00:00+00:00"><meta property="article:modified_time" content="2023-03-06T00:00:00+00:00"><meta property="og:site_name" content="MMOX"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/img/profile.png"><meta name=twitter:title content="Let's Defend - RanDev"><meta name=twitter:description content="Digital Forensic Memory Dump challenge Writeup "><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Let's Defend - RanDev","item":"http://localhost:1313/posts/writeups/ran-dev/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Let's Defend - RanDev","name":"Let\u0027s Defend - RanDev","description":"Digital Forensic Memory Dump challenge Writeup ","keywords":["Lets defend","Writeups","Digital Forensics","Memory","Ransomware"],"articleBody":" Description We hired a full stack developer but seems he faked all his experience and he is just lazy developer and got attacked by a weird ransomware can you investigate what happened ? Questions Q1: What is the bitcoin wallet address that the hacker left Q2: What is the SHA256 of the Ransomware Q3: What is the full URL that downloaded the ransomware? Q4: What function executed the ransomware? Q5: What is the extension of the ransomware? Q6: The Ransomware contain a fake key to encrypt the files? Q7: What is the KEY that encrypted the data? Q8: After getting the correct key can you decrypt Tasks.txt and tell me how many tasks there are? Tools Tools Required 1- Volatility 2- IDA Pro or any disassembler 3- Command Line 4- Scripting or Cyberchef 5- DB Browser Writeup in this challenge I got a memory dump. so let’s check the operating system of the memory.\npython3 vol.py -f RanDev.vmem windows.info well it seems it’s Windows10. so let’s check the process in this dump.\npython3 vol.py -f RanDev.vmem windows.psscan after wenting through the process I didn’t any suspicious process that ran on the system. let’s see the first hint of the first question\nQ1 Hint: Did you check desktop? the hint says I need to check the desktop. so let’s filescan and check desktop.\npython3 vol.py -f RanDev.vmem windows.filescan \u003e files.txt strings files.txt | grep -i \"Desktop\" okay now I got all files on the desktop on the system and I noticed that there is a file called \" Tasks.txt\" so let’s dump this file and check what does it contain.\npython3 vol.py -f RanDev.vmem windows.dumpfiles --virtaddr 0xa001c1a9fb60 it seems the file is encrypted so I need to keep checking the desktop to find another thing.\nand yes I noticed another file called “note.txt” so let’s dump and hope we find something useful this time.\npython3 vol.py -f RanDev.vmem windows.dumpfiles --virtaddr 0xa001c401ed40 cat file.0xa001c401ed40.0xa001c4d52850.DataSectionObject.note.txt.dat and yes we got the bitcoin wallet addess which is\nQ1 Answer: bc1qwe5qxdj7aekpj8aeeeey6tf5hjzugk3jkax6lm Now let’s head to the second question and it says\nQ2: What is the SHA256 of the Ransomware But I don’t know where can I find the Ransomware so after checking the Hint\nQ2 Hint: executable file! the hint says executable file so let’s try to grep any “.exe” file in the files we got\nstrings files.txt | grep -i \".exe\" well i noticed that there is an executable file called “R.exe” and I guess it’s it let’ dump it and check it on virustotal\npython3 vol.py -f RanDev.vmem windows.dumpfiles --virtaddr 0xa001c5439960 well it seems it’s really suspicious so let’s get the SHA256 and submit it.\nsha256sum file.0xa001c5439960.0xa001c4558110.DataSectionObject.R.exe.dat and yes the Answer for the second question is\nQ2 Answer: d22aff59eae7201e6a4f82dbe99173c7103665beaa0860f81db7130f38c99a35 Let’s head to the third question which is\nQ3: What is the full URL that downloaded the ransomware? Hmmmm how can I get the URL if I got the netstat or netscan I won’t able to get the full URL but there is another way we can use by checking the history of the browser. so the process I saw there was “Microsoft Edge” ran on the PC. so let’s google how to find the history in files system and I got it the directory of it which is.\n\\Users\\USERPROFILE\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\History so let’s back to files and dump that file.\npython3 vol.py -f RanDev.vmem windows.dumpfiles --virtaddr 0xa001c541ea20 after dumping it I checked the history through “DB Browser”.\nI found out that the last URL he visited was “localhost/login.php”. so let’s check the hint of the third question.\nQ3 Hint: The developer ran local server Well well well let’s check the files of that ran server. I checked that there is xampp already installed and ran on the PC from the process. so let’s check the directory of the server files.\nC:\\xampp\\htdocs strings files.txt | grep -i \"htdocs\" well well well we got some interesting files let’s dump the login and authentication.php\npython3 vol.py -f RanDev.vmem windows.dumpfiles --virtaddr 0xa001c517d3d0 python3 vol.py -f RanDev.vmem windows.dumpfiles --virtaddr 0xa001c54102e0 the login.php wasn’t very interesting so much so let’s check authentication.php.\nwell well well this is very interesting. fileURL vairable seems base64 so let’s decode it.\nnow we got the answer of the third question which is.\nQ3 Answer: http://192.168.235.137/download/R.exe Also the fourth question\nQ4: What function executed the ransomware? I went through the code and found out that\nthis execute the file, so answer is\nQ4 Answer : exec(); Let’s head to the fifth question and see what we need there.\nQ5: The Ransomware contain a fake key to encrypt the files? I went through the pc but couldn’t find anything. so let’s see the hint\nQ5 Hint: Some reverse required here. Hmm reverse required it seems we need to make reverse engineering on the Ransomware to get the answer of the question so let’s open the “R.exe” on IDA pro or any disassember.\nohh some interesting stuffs. let’s investigate it and see what we can extract from it. and we need the fake key so let’s make this assembly more clear by convert into pesudo code\nnow it’s clear for us to get the key.\nQ5 Answer: KRKTCUCXIZJESUSVNBBFCMDUIZKWOPJ5 and about the sixth question.\nQ6: What is the extension of the ransomware? we need to find the extension of the encrypted files. and finally about looking for a good amount of time I reached the extension which it was inside a fucntion called “xor_encryption”.\nWhich if you see the image below has the extension that beeing added\nSo the answer of the sixth question is\nQ6 Answer: .D7k and the 7th question is\nQ7: What is the Correct KEY that encrypted the data? as we can got the previous key was fake so let’s check the “xor_encryption” function again and try to get the correct key.\nI noticed in this part that it xor the data with key “0x2C” so let’s try to submit it. well it’s correct key\nQ7 Answer: 0x2C and the last question is\nQ8: After getting the correct key can you decrypt Tasks.txt and tell me how many tasks are there? now we have everything all we need is to create a script to xor the data with key “0x2C”\nkey = 0x2C with open('Tasks.txt', 'rb') as infile, open('Tasks.txt', 'wb') as outfile: contents = infile.read() decrypt = bytes([byte ^ key for byte in contents]) outfile.write(decrypt) seems the answer is\nQ8: 17 hope you enjoyed and thanks Thank you\n","wordCount":"1073","inLanguage":"en","datePublished":"2023-03-06T00:00:00Z","dateModified":"2023-03-06T00:00:00Z","author":{"@type":"Person","name":"MMOX "},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/writeups/ran-dev/"},"publisher":{"@type":"Organization","name":"MMOX Blog","logo":{"@type":"ImageObject","url":"http://localhost:1313/img/Favicon.webp"}}}</script></head><body id=top><script crossorigin=anonymous src=/assets/js/theme.b20f95bb4da41ef90a2610a557a7000b2649a3f47282ec571676da6fc0427200.js integrity="sha256-sg+Vu02kHvkKJhClV6cACyZJo/RyguxXFnbab8BCcgA="></script><header class=header><div id=progressBar></div><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="MMOX (Alt + H)">MMOX</a>
<button type=button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><input name=hamburger-input id=hamburger-input type=checkbox aria-label="Navigation Menu">
<label id=hamburger-menu for=hamburger-input></label><div class=overlay></div><ul id=menu><li><a href=http://localhost:1313/posts/ title=Posts><span>Posts</span></a></li><li><a href=http://localhost:1313/categories/ title=Categories><span>Categories</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:1313/mylabs/ title=MyLabs><span>MyLabs</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Let's Defend - RanDev
<span class=entry-hint title=Draft><svg height="35" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h1><div class=post-description>Digital Forensic Memory Dump challenge Writeup</div><div class=post-meta><span title='2023-03-06 00:00:00 +0000 UTC'>March 6, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;MMOX</div><div class=post-meta></div></header><div class="toc side"><details id=toc><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#description aria-label=Description>Description</a></li><li><a href=#questions aria-label=Questions>Questions</a></li><li><a href=#tools aria-label=Tools>Tools</a></li><li><a href=#writeup aria-label=Writeup>Writeup</a></li></ul></div></details></div><div class=post-content><p><img loading=lazy src=/postImgs/letsdefend/RanDev/logo.png alt=logo></p><h1 id=description>Description<a hidden class=anchor aria-hidden=true href=#description>#</a></h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>We hired a full stack developer but seems he faked all his experience and he is just lazy developer and got attacked by a weird ransomware can you investigate what happened ?
</span></span></code></pre></div><h1 id=questions>Questions<a hidden class=anchor aria-hidden=true href=#questions>#</a></h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>Q1</span><span class=p>:</span> <span class=n>What</span> <span class=n>is</span> <span class=n>the</span> <span class=n>bitcoin</span> <span class=n>wallet</span> <span class=n>address</span> <span class=n>that</span> <span class=n>the</span> <span class=n>hacker</span> <span class=n>left</span>
</span></span><span class=line><span class=cl><span class=n>Q2</span><span class=p>:</span> <span class=n>What</span> <span class=n>is</span> <span class=n>the</span> <span class=n>SHA256</span> <span class=n>of</span> <span class=n>the</span> <span class=n>Ransomware</span>
</span></span><span class=line><span class=cl><span class=n>Q3</span><span class=p>:</span> <span class=n>What</span> <span class=n>is</span> <span class=n>the</span> <span class=n>full</span> <span class=n>URL</span> <span class=n>that</span> <span class=n>downloaded</span> <span class=n>the</span> <span class=n>ransomware</span><span class=err>?</span>
</span></span><span class=line><span class=cl><span class=n>Q4</span><span class=p>:</span> <span class=n>What</span> <span class=n>function</span> <span class=n>executed</span> <span class=n>the</span> <span class=n>ransomware</span><span class=err>?</span>
</span></span><span class=line><span class=cl><span class=n>Q5</span><span class=p>:</span> <span class=n>What</span> <span class=n>is</span> <span class=n>the</span> <span class=n>extension</span> <span class=n>of</span> <span class=n>the</span> <span class=n>ransomware</span><span class=err>?</span>
</span></span><span class=line><span class=cl><span class=n>Q6</span><span class=p>:</span> <span class=n>The</span> <span class=n>Ransomware</span> <span class=n>contain</span> <span class=n>a</span> <span class=n>fake</span> <span class=n>key</span> <span class=n>to</span> <span class=n>encrypt</span> <span class=n>the</span> <span class=n>files</span><span class=err>?</span>
</span></span><span class=line><span class=cl><span class=n>Q7</span><span class=p>:</span> <span class=n>What</span> <span class=n>is</span> <span class=n>the</span> <span class=n>KEY</span> <span class=n>that</span> <span class=n>encrypted</span> <span class=n>the</span> <span class=n>data</span><span class=err>?</span>
</span></span><span class=line><span class=cl><span class=n>Q8</span><span class=p>:</span> <span class=n>After</span> <span class=n>getting</span> <span class=n>the</span> <span class=n>correct</span> <span class=n>key</span> <span class=n>can</span> <span class=n>you</span> <span class=n>decrypt</span> <span class=n>Tasks</span><span class=o>.</span><span class=n>txt</span> <span class=ow>and</span> <span class=n>tell</span> <span class=n>me</span> <span class=n>how</span> <span class=n>many</span> <span class=n>tasks</span> <span class=n>there</span> <span class=n>are</span><span class=err>?</span>
</span></span></code></pre></div><h1 id=tools>Tools<a hidden class=anchor aria-hidden=true href=#tools>#</a></h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Tools Required
</span></span><span class=line><span class=cl>1- Volatility
</span></span><span class=line><span class=cl>2- IDA Pro or any disassembler
</span></span><span class=line><span class=cl>3- Command Line
</span></span><span class=line><span class=cl>4- Scripting or Cyberchef
</span></span><span class=line><span class=cl>5- DB Browser
</span></span></code></pre></div><h1 id=writeup>Writeup<a hidden class=anchor aria-hidden=true href=#writeup>#</a></h1><p>in this challenge I got a memory dump.
<img loading=lazy src=/postImgs/letsdefend/RanDev/1.png alt=1></p><p>so let&rsquo;s check the operating system of the memory.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>python3 vol.py -f RanDev.vmem windows.info
</span></span></code></pre></div><p><img loading=lazy src=/postImgs/letsdefend/RanDev/2.png alt=2></p><p>well it seems it&rsquo;s Windows10. so let&rsquo;s check the process in this dump.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>python3 vol.py -f RanDev.vmem windows.psscan
</span></span></code></pre></div><p><img loading=lazy src=/postImgs/letsdefend/RanDev/3.png alt=3></p><p>after wenting through the process I didn&rsquo;t any suspicious process that ran on the system. let&rsquo;s see the first hint of the first question</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q1 Hint: Did you check desktop?
</span></span></code></pre></div><p>the hint says I need to check the desktop. so let&rsquo;s filescan and check desktop.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>python3 vol.py -f RanDev.vmem windows.filescan &gt; files.txt
</span></span><span class=line><span class=cl>strings files.txt | grep -i &#34;Desktop&#34;
</span></span></code></pre></div><p><img loading=lazy src=/postImgs/letsdefend/RanDev/4.png alt=4>
okay now I got all files on the desktop on the system and I noticed that there is a file called " Tasks.txt" so let&rsquo;s dump this file and check what does it contain.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>python3 vol.py -f RanDev.vmem windows.dumpfiles --virtaddr 0xa001c1a9fb60
</span></span></code></pre></div><p><img loading=lazy src=/postImgs/letsdefend/RanDev/5.png alt=5></p><p>it seems the file is encrypted so I need to keep checking the desktop to find another thing.</p><p><img loading=lazy src=/postImgs/letsdefend/RanDev/6.png alt=6></p><p>and yes I noticed another file called &ldquo;note.txt&rdquo; so let&rsquo;s dump and hope we find something useful this time.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>python3 vol.py -f RanDev.vmem windows.dumpfiles --virtaddr 0xa001c401ed40
</span></span><span class=line><span class=cl>cat file.0xa001c401ed40.0xa001c4d52850.DataSectionObject.note.txt.dat
</span></span></code></pre></div><p><img loading=lazy src=/postImgs/letsdefend/RanDev/7.png alt=7></p><p>and yes we got the bitcoin wallet addess which is</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q1 Answer: bc1qwe5qxdj7aekpj8aeeeey6tf5hjzugk3jkax6lm
</span></span></code></pre></div><p>Now let&rsquo;s head to the second question and it says</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q2: What is the SHA256 of the Ransomware
</span></span></code></pre></div><p>But I don&rsquo;t know where can I find the Ransomware so after checking the Hint</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q2 Hint: executable file!
</span></span></code></pre></div><p>the hint says executable file so let&rsquo;s try to grep any &ldquo;.exe&rdquo; file in the files we got</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>strings files.txt | grep -i &#34;.exe&#34;
</span></span></code></pre></div><p><img loading=lazy src=/postImgs/letsdefend/RanDev/8.png alt=8></p><p>well i noticed that there is an executable file called &ldquo;R.exe&rdquo; and I guess it&rsquo;s it let&rsquo; dump it and check it on virustotal</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>python3 vol.py -f RanDev.vmem windows.dumpfiles --virtaddr 0xa001c5439960
</span></span></code></pre></div><p><img loading=lazy src=/postImgs/letsdefend/RanDev/9.png alt=9></p><p>well it seems it&rsquo;s really suspicious so let&rsquo;s get the SHA256 and submit it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sha256sum file.0xa001c5439960.0xa001c4558110.DataSectionObject.R.exe.dat
</span></span></code></pre></div><p>and yes the Answer for the second question is</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q2 Answer: d22aff59eae7201e6a4f82dbe99173c7103665beaa0860f81db7130f38c99a35
</span></span></code></pre></div><p>Let&rsquo;s head to the third question which is</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>Q3</span><span class=p>:</span> <span class=n>What</span> <span class=n>is</span> <span class=n>the</span> <span class=n>full</span> <span class=n>URL</span> <span class=n>that</span> <span class=n>downloaded</span> <span class=n>the</span> <span class=n>ransomware</span><span class=err>?</span>
</span></span></code></pre></div><p>Hmmmm how can I get the URL if I got the netstat or netscan I won&rsquo;t able to get the full URL but there is another way we can use by checking the history of the browser.
so the process I saw there was &ldquo;Microsoft Edge&rdquo; ran on the PC. so let&rsquo;s google how to find the history in files system and I got it the directory of it which is.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>\Users\USERPROFILE\AppData\Local\Microsoft\Edge\User Data\Default\History
</span></span></code></pre></div><p>so let&rsquo;s back to files and dump that file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>python3 vol.py -f RanDev.vmem windows.dumpfiles --virtaddr 0xa001c541ea20
</span></span></code></pre></div><p>after dumping it I checked the history through &ldquo;DB Browser&rdquo;.</p><p><img loading=lazy src=/postImgs/letsdefend/RanDev/10.png alt=10></p><p>I found out that the last URL he visited was &ldquo;localhost/login.php&rdquo;. so let&rsquo;s check the hint of the third question.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q3 Hint: The developer ran local server
</span></span></code></pre></div><p>Well well well let&rsquo;s check the files of that ran server. I checked that there is xampp already installed and ran on the PC from the process.
<img loading=lazy src=/postImgs/letsdefend/RanDev/11.png alt=11></p><p>so let&rsquo;s check the directory of the server files.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>C:\xampp\htdocs
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>strings files.txt | grep -i &#34;htdocs&#34;
</span></span></code></pre></div><p><img loading=lazy src=/postImgs/letsdefend/RanDev/12.png alt=12></p><p>well well well we got some interesting files let&rsquo;s dump the login and authentication.php</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>python3 vol.py -f RanDev.vmem windows.dumpfiles --virtaddr 0xa001c517d3d0
</span></span><span class=line><span class=cl>python3 vol.py -f RanDev.vmem windows.dumpfiles --virtaddr 0xa001c54102e0
</span></span></code></pre></div><p><img loading=lazy src=/postImgs/letsdefend/RanDev/13.png alt=13></p><p>the login.php wasn&rsquo;t very interesting so much so let&rsquo;s check authentication.php.</p><p><img loading=lazy src=/postImgs/letsdefend/RanDev/14.png alt=14></p><p>well well well this is very interesting. fileURL vairable seems base64 so let&rsquo;s decode it.</p><p><img loading=lazy src=/postImgs/letsdefend/RanDev/15.png alt=15></p><p>now we got the answer of the third question which is.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>Q3</span> <span class=n>Answer</span><span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>192.168</span><span class=o>.</span><span class=mf>235.137</span><span class=o>/</span><span class=n>download</span><span class=o>/</span><span class=n>R</span><span class=o>.</span><span class=n>exe</span>
</span></span></code></pre></div><p>Also the fourth question</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q4: What function executed the ransomware?
</span></span></code></pre></div><p>I went through the code and found out that</p><p><img loading=lazy src=/postImgs/letsdefend/RanDev/16.png alt=16></p><p>this execute the file, so answer is</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q4 Answer : exec();
</span></span></code></pre></div><p>Let&rsquo;s head to the fifth question and see what we need there.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q5: The Ransomware contain a fake key to encrypt the files?
</span></span></code></pre></div><p>I went through the pc but couldn&rsquo;t find anything. so let&rsquo;s see the hint</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q5 Hint: Some reverse required here.
</span></span></code></pre></div><p>Hmm reverse required it seems we need to make reverse engineering on the Ransomware to get the answer of the question so let&rsquo;s open the &ldquo;R.exe&rdquo; on IDA pro or any disassember.</p><p><img loading=lazy src=/postImgs/letsdefend/RanDev/17.png alt=17></p><p>ohh some interesting stuffs. let&rsquo;s investigate it and see what we can extract from it.
and we need the fake key so let&rsquo;s make this assembly more clear by convert into pesudo code</p><p><img loading=lazy src=/postImgs/letsdefend/RanDev/18.png alt=18></p><p>now it&rsquo;s clear for us to get the key.</p><p><img loading=lazy src=/postImgs/letsdefend/RanDev/19.png alt=19></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q5 Answer: KRKTCUCXIZJESUSVNBBFCMDUIZKWOPJ5
</span></span></code></pre></div><p>and about the sixth question.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q6: What is the extension of the ransomware?
</span></span></code></pre></div><p>we need to find the extension of the encrypted files.
and finally about looking for a good amount of time I reached the extension which it was inside a fucntion called &ldquo;xor_encryption&rdquo;.</p><p><img loading=lazy src=/postImgs/letsdefend/RanDev/21.png alt=21></p><p>Which if you see the image below has the extension that beeing added</p><p><img loading=lazy src=/postImgs/letsdefend/RanDev/20.png alt=20></p><p>So the answer of the sixth question is</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q6 Answer: .D7k
</span></span></code></pre></div><p>and the 7th question is</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q7: What is the Correct KEY that encrypted the data?
</span></span></code></pre></div><p>as we can got the previous key was fake so let&rsquo;s check the &ldquo;xor_encryption&rdquo; function again and try to get the correct key.</p><p><img loading=lazy src=/postImgs/letsdefend/RanDev/22.png alt=22></p><p>I noticed in this part that it xor the data with key &ldquo;0x2C&rdquo; so let&rsquo;s try to submit it.
well it&rsquo;s correct key</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q7 Answer: 0x2C
</span></span></code></pre></div><p>and the last question is</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q8: After getting the correct key can you decrypt Tasks.txt and tell me how many tasks are there?
</span></span></code></pre></div><p>now we have everything all we need is to create a script to xor the data with key &ldquo;0x2C&rdquo;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=mh>0x2C</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;Tasks.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>infile</span><span class=p>,</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;Tasks.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>outfile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>contents</span> <span class=o>=</span> <span class=n>infile</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>decrypt</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>([</span><span class=n>byte</span> <span class=o>^</span> <span class=n>key</span> <span class=k>for</span> <span class=n>byte</span> <span class=ow>in</span> <span class=n>contents</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>outfile</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>decrypt</span><span class=p>)</span>
</span></span></code></pre></div><p><img loading=lazy src=/postImgs/letsdefend/RanDev/23.png alt=23></p><p>seems the answer is</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Q8: 17
</span></span></code></pre></div><blockquote><p>hope you enjoyed and thanks Thank you</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/lets-defend/>Lets Defend</a></li><li><a href=http://localhost:1313/tags/writeups/>Writeups</a></li><li><a href=http://localhost:1313/tags/digital-forensics/>Digital Forensics</a></li><li><a href=http://localhost:1313/tags/memory/>Memory</a></li><li><a href=http://localhost:1313/tags/ransomware/>Ransomware</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/letsdefend/pcap-analysis/><span class=title>« Prev</span><br><span>Let's Defend - PCAP Analysis</span>
</a><a class=next href=http://localhost:1313/posts/writeups/wanna-story/><span class=title>Next »</span><br><span>Let's Defend - Wanna Story</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Let's Defend - RanDev on x" href="https://x.com/intent/tweet/?text=Let%27s%20Defend%20-%20RanDev&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fran-dev%2f&amp;hashtags=Letsdefend%2cWriteups%2cDigitalForensics%2cMemory%2cRansomware"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Let's Defend - RanDev on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fran-dev%2f&amp;title=Let%27s%20Defend%20-%20RanDev&amp;summary=Let%27s%20Defend%20-%20RanDev&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fran-dev%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Let's Defend - RanDev on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fran-dev%2f&title=Let%27s%20Defend%20-%20RanDev"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Let's Defend - RanDev on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fran-dev%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Let's Defend - RanDev on whatsapp" href="https://api.whatsapp.com/send?text=Let%27s%20Defend%20-%20RanDev%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fran-dev%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Let's Defend - RanDev on telegram" href="https://telegram.me/share/url?text=Let%27s%20Defend%20-%20RanDev&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fran-dev%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Let's Defend - RanDev on ycombinator" href="https://news.ycombinator.com/submitlink?t=Let%27s%20Defend%20-%20RanDev&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwriteups%2fran-dev%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><html></html></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>MMOX Blog</a></span>
<span>- Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer">Hugo</a> &
        <a href=https://github.com/Wonderfall/hugo-WonderMod/ rel=noopener>WonderMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script defer crossorigin=anonymous src=/assets/js/papermod.7ea300eda6d3653624a576fbc095ccd8a0c2977756acbe5de4114132a72cc7fa.js integrity="sha256-fqMA7abTZTYkpXb7wJXM2KDCl3dWrL5d5BFBMqcsx/o="></script></body></html>