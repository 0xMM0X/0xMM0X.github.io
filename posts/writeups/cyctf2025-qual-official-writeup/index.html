<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CyCTF2025 Qual DFIR Official writeup | MMOX Blog</title>
<meta name=keywords content="CyCTF2025,Writeups,Digital Forensics,Memory,WMI,Docker Forensics"><meta name=description content="CyCTF2025 Qual DFIR Official writeup"><meta name=author content="MMOX, Anne, Mokey, Samer"><link rel=canonical href=https://mmox.me/posts/writeups/cyctf2025-qual-official-writeup/><meta name=google-site-verification content="G-PK6NYWT73S"><meta name=msvalidate.01 content="DBD2C24F1154E160699876B8EB3374F0"><link crossorigin=anonymous href=/assets/css/stylesheet.5d45b8bd1a3cf526e72959d51f1bdc688d8e97fa0df2a697a93df6bdc746feb4.css integrity="sha256-XUW4vRo89SbnKVnVHxvcaI2Ol/oN8qaXqT32vcdG/rQ=" rel="preload stylesheet" as=style><noscript><link crossorigin=anonymous href=/css/includes/noscript.30127fa68e36d08f5dd7f9d4e717dac42e729b844672afd0fbcacb0d9e508595.css integrity="sha256-MBJ/po420I9d1/nU5xfaxC5ym4RGcq/Q+8rLDZ5QhZU=" rel="preload stylesheet" as=style></noscript><link rel=icon href=https://mmox.me/img/Favicon.webp><link rel=icon type=image/png sizes=16x16 href=https://mmox.me/img/Favicon.webp><link rel=icon type=image/png sizes=32x32 href=https://mmox.me/img/Favicon.webp><link rel=apple-touch-icon href=https://mmox.me/img/Favicon.webp><link rel=mask-icon href=https://mmox.me/img/Favicon.webp><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://mmox.me/posts/writeups/cyctf2025-qual-official-writeup/><script async src="https://www.googletagmanager.com/gtag/js?id=G-PK6NYWT73S"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PK6NYWT73S")}</script><meta property="og:title" content="CyCTF2025 Qual DFIR Official writeup"><meta property="og:description" content="CyCTF2025 Qual DFIR Official writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://mmox.me/posts/writeups/cyctf2025-qual-official-writeup/"><meta property="og:image" content="https://mmox.me/img/profile.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-08T00:00:00+00:00"><meta property="article:modified_time" content="2025-11-08T00:00:00+00:00"><meta property="og:site_name" content="MMOX"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://mmox.me/img/profile.png"><meta name=twitter:title content="CyCTF2025 Qual DFIR Official writeup"><meta name=twitter:description content="CyCTF2025 Qual DFIR Official writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://mmox.me/posts/"},{"@type":"ListItem","position":2,"name":"CyCTF2025 Qual DFIR Official writeup","item":"https://mmox.me/posts/writeups/cyctf2025-qual-official-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CyCTF2025 Qual DFIR Official writeup","name":"CyCTF2025 Qual DFIR Official writeup","description":"CyCTF2025 Qual DFIR Official writeup","keywords":["CyCTF2025","Writeups","Digital Forensics","Memory","WMI","Docker Forensics"],"articleBody":"DokDok Challenge Overview Name: DokDok\nLevel: Easy\nLink: docker pull mmox/dokdok\nScenario A CyAPT group abused a public Docker image to stage a quick web deployment and drop a memory-resident miner. The attacker attempted to cover their tracks by removing the payload after installation. Your job is to recover evidence from the image layers and answer three questions:\nAttacker wallet address (Ethereum-style 0x...) Cryptocurrency balance remaining in that wallet Malware group name (APT name) Flag format:\nCyCTF{wallet_balance_name}\nWalkthrough Step 1 – Pull the image docker pull mmox/dokdok Step 2 – Save the image to a .tar file docker save mmox/dokdok -o dokdok.tar This exports the Docker image to a tar archive (dokdok.tar), allowing offline transfer and analysis.\nInspecting image layers By unarchiving the image layers you will find a file named IMPORTANT inside the layer with ID af89492eb8f755a7d12c55b850e792bc2acaf1640ba7eb2b6cf6aae74e44600f.\nA quick strings check shows the file is UPX-packed.\nUnpack the binary:\nupx -d IMPORTANT A short reverse engineering step reveals a function that decodes the wallet address:\n_BYTE *decode_wallet_internal() { _BYTE *v1; // [rsp+0h] [rbp-10h] unsigned __int64 i; // [rsp+8h] [rbp-8h] v1 = malloc(0x2BuLL); if ( !v1 ) return 0LL; for ( i = 0LL; i \u003c 0x2A; ++i ) v1[i] = XOR_KEY[i % 0xB] ^ OBF_WALLET[i]; v1[42] = 0; return v1; } This function XORs the wallet address with an XOR key; both the key and the obfuscated wallet are stored in the data sections.\nAfter XOR-decoding, you obtain the wallet address:\n0x460ab1c34e4388704c5e56e18D904Ed117D077CC To get the balance, search the wallet on Ethplorer (or a similar blockchain explorer):\nhttps://ethplorer.io/address/0x460ab1c34e4388704c5e56e18d904ed117d077cc#\nBalance found:\n0.08784870748313268\nFor the APT name, a quick web search of the wallet shows the group name in the first result:\nAPT name: Lazarus\nFinal flag:\nCyCTF{0x460ab1c34e4388704c5e56e18D904Ed117D077CC_0.08784870748313268_Lazarus}\nHidden In Plain Sight Challenge Overview Name: HiddenInPlainSight\nLevel: Medium\nFiles: HiddenInPlain.zip\nFile password: CyCTF2025#DFIR\nSHA256: 2420cc73d3d7be32af405929cee38bb818eaa06f48c50931c785937a7b15f9ae\nLink: Download challenge\nScenario An HR staff member received a phishing email from an attacker posing as an HR colleague requesting a résumé review. The user downloaded a malicious PDF that resulted in system compromise.\nTask: identify red flags and recover the two-part flag: CyCTF{part1_part2}\nWalkthrough 1) Evidence of file/folder opening .lnk files and RecentDocs may not show the malicious PDF if the delivered file is actually an executable renamed as a PDF. However, we can detect the data staging folder:\n.lnk evidence: 2) Evidence of execution Amcache provided little useful information in this case.\nPrefetch shows evidence of execution of the malicious PDF/executable:\n3) Persistence A malicious scheduled task was discovered:\nAnalysis: the scheduled task executes a payload stored inside the WMI repository. The WMI entry is located at:\nNamespace: root\\cimv2 ClassName: windowsupdate Filter: Name=\"MyHiddenPayload\" The payload is executed directly in memory.\n4) Parsing WMI (Flag — part 1) The WMI repository data is not plain text (strings appear garbled). Use a WMI-parsing tool that can read the repository (for example, Mandiant’s python-cim sample tools):\nRepository: https://github.com/mandiant/flare-wmi/tree/master/python-cim/samples\nTool installation / usage #!/bin/bash # clone the repo sudo git clone https://github.com/mandiant/flare-wmi.git # install python venv sudo apt install python3-venv # inside the repo, create the venv cd flare-wmi python3 -m venv venv # activate it (do not use sudo when activating) source venv/bin/activate # install library dependencies in the virtualenv env/bin/pip install python-cim env/bin/pip install construct tqdm # timeline example python3 timeline.py [repo path] # dump class instance python3 dump_class_instance.py win7 \"repo_path\" \"namespace\" \"classname\" Note: the python-cim package in PyPI may be outdated; you may need to use the provided GitHub scripts to avoid errors.\nTool in action Decoding details\nKey: 0x45 (decimal 69) — the stored array appears XOR-encoded. The stored byte array (decimal) is: EncodedCommand=[36, 18, 19, 113, 12, 6, 45, 39, 16, 118, 41, 63, 33, 2, 19, 49, 9, 41, 23, 41, 32, 13, 20, 48, 23, 18, 112, 47, 39, 119, 23, 53, 39, 40, 33, 33, 10, 47, 53, 19, 19, 0, 28, 113, 9, 46, 33, 41, 33, 3, 11, 117, 38, 40, 41, 48, 31, 60, 34, 42, 36, 29, 33, 60, 12, 2, 45, 117, 33, 13, 4, 115, 9, 60, 124, 116, 38, 2, 23, 45, 33, 2, 19, 63, 9, 40, 116, 53, 28, 118, 15, 51, 38, 63, 7, 40, 33, 6, 112, 47, 39, 119, 117, 115, 10, 1, 4, 113, 8, 6, 124, 50, 28, 29, 15, 117, 8, 22, 124, 12, 8, 18, 20, 61, 39, 40, 38, 61, 39, 41, 7, 54, 28, 17, 3, 48, 20, 63, 3, 11, 16, 63, 3, 43, 36, 13, 20, 51, 31, 40, 41, 54, 31, 22, 112, 50, 38, 63, 0, 34, 9, 19, 19, 63, 31, 16, 15, 45, 38, 119, 41, 47, 16, 2, 3, 60, 38, 119, 41, 48, 31, 60, 46, 48, 20, 119, 124, 48, 33, 2, 19, 48, 33, 6, 46, 53] Using a simple Python XOR decoder (XOR with key=96 in this dataset — see the sample script), the decoded string (Part 1) is:\nH1d1ng1nPla1nC1MS1ght 5) Data exfiltration (Flag — part 2) The attacker used Background Intelligent Transfer Service (BITS) to exfiltrate the staged data.\nFindings:\nBITS client logs (Job started events IDs 3 and 59) record the job name, the URL, and the file size, but they do not record the original staged file name. Example evidence: Part 2 (decoded / discovered): ALittleBITSofData\nFinal flag CyCTF{H1d1ng1nPla1nC1MS1ght_ALittleBITSofData} Corrupted Challenge Overview Name: Corrupted\nLevel: Hard\nFiles: corrupted.zip\nSHA256: e3283de65cdc1be4634983540d732268e5431e0583cf0b35850659612dc2aa83\nLink: Download challenge\nStory Our organization was hit by a sophisticated APT. During the incident we captured a memory dump, but the attacker corrupted the dump, wiped server traces, and halted operations.\nFortunately, an experimental tool salvaged page table fragments; these fragments may be the only clues left to identify the threat actor we call APT M.\nMission: analyze the corrupted memory dump, recover evidence, and uncover the attacker.\nThe technical objective is to demonstrate how to walk memory manually without relying on Volatility — for example, in cases where a brand-new Windows kernel version is not yet supported by existing tools.\nThis challenge was inspired by Mohamed Labib.\nChallenge discovery After extracting corrupted.zip, you will find:\ncorrupted → the main memory dump pagetable.backup → a file containing partial page table entries The usual first step is to run Volatility on the dump.\nVolatility mission I’m using volatility 2 (Yes I am very old, i know) so I will start by getting the memory suggested profiles.\nand it’s windows 7 64 bit .\ntime to check running processes, using pslist plugin.\nbut , no thing found voltility couldent follow the KDOM double linked list to find the running processes.\nThe description said that the dump is corrupted, not encrypted, so if we could do a brute force search for the EPROCESS header bytes regardless of the pages we could find the present process on the system.\nso psscan shold give us some output .\nAs expected, psscan did the mission.\nand its clear from the process named FOLLOWMYHEAP that the flag is on its heap .\nbut where to find the process heap and heaps !\nin process Peb structure we can find a pointer to process heap.[1]\nand peb is part of EPROCESS struct .\nbut we can’t use volatility shell to work with the internals because the dump is corrupted, the only way for us is to use a hex-editor. Walk through internals we will not start from point 0, because we got important information from psscan which is the physical address of the target process , which is 0xf51fd50\nyou can start by jumping to this location.\nnow we are standing on the start byte of the target eprocess struct.\nkernel version the next step we need to know the kenel verion of this mechine , we can do it in 2 wayes .\nthe first is to search for windows7 kernel verion.[2]\nwindows 7 version is 6.1 .\nthe second way is to use the process id and search for it in the struct, once you find its location you can search for which version PID will be in this position.\nyou will find that pid location is 0x180 , search for pid with location 0x180 in eprocess struct.[3]\nwe need to find the location of Peb in version 6.1.[4]\nAnd peb location in process address space is 0x338 .\nnow we will jump to a Peb location which is 0xf520088\nPeb once we jump to the peb location , we will find the 8 byte pointer.\nDon’t forget to swap the endianness\npointer value is : 0x40212220\nPeb pointer points to a virtual memory location so we need to get the physical memory address from this virtual memory.\nVtoP To calculate the physical memory from the virtual memory in a 64-bit system we need to parse the 64 pointer bits to page directory pointer, page directory, page table, page table entry, physical page offset.[5]\nwe can do it using a small python script\nimport sys v_mem = int(sys.argv[1],16) bin_holder = (bin(v_mem)[2:])[::-1] while len(bin_holder) \u003c 48 : bin_holder += \"0\" Page_Offset = hex(int(bin_holder[:12][::-1], 2)) PTE = str(int(bin_holder[12:21][::-1], 2)) PT = str(int(bin_holder[21:30][::-1], 2)) PD = str(int(bin_holder[30:39][::-1], 2)) PDP = str(int(bin_holder[39:][::-1], 2)) print(\"page directory pointer : \" + PDP +\"\\npage directory : \" + PD +\"\\npage table : \" + PT + \"\\npage table entry : \" + PTE + \"\\nphysical page offset : \" + Page_Offset ) when we use the peb pointer as an input\nwe have all information to get the last part of the physical address, we just need to search the pagetable file using the page pointers we got from the script.\nnow concatenate the number we got from the page table and the physical page offset to get the physical address.\nthe physical address of peb is 0x2761220\nget heap the last thing to do is to get the heap pointer from peb, once the description said process heap so we need only to jump to the heap pointer and no need to parse the heap’s table pointer and go through each one.\nNOTE: heap is real memory will point to address in process address space, but here I modified the pointer to point to a physical address so you will not have to vtop again.\nso we need to jump to 0x2761250\nthe last jump will be to 0x2c9220\nand not a completely bingooo , you just need to reorganize the flag.\nget flag collect the flag bytes and locations from the heap.\nues a scaript get the flag\nimport base64 flag = 'GZXuV0SpzVDXmZl10pbRYMl1yR99QwI3INmezQMEyd7wdXFm' flo = [10, 7, 25, 16, 5, 34, 46, 12, 22, 31, 4, 42, 14, 17, 15, 18, 26, 28, 37, 43, 41, 21, 3, 11, 32, 27, 19, 48, 1, 36, 20, 2, 45, 23, 38, 13, 44, 9, 35, 6, 40, 39, 8, 24, 29, 33, 47, 30] newfl = '' for i in range(len(flo)): ind = flo.index(i+1) newfl += flag[ind] print(newfl) print(base64.b64decode(newfl).decode()) congratulations KING\nresources 1- PEB overview\n2- kernel version\n3- Eprocess struct\n4- PEB struct\n5- virtual memory to physical in win 64 bit\nTrust Leak I am so tired so maybe i will write it soon ","wordCount":"1849","inLanguage":"en","datePublished":"2025-11-08T00:00:00Z","dateModified":"2025-11-08T00:00:00Z","author":{"@type":"Person","name":"MMOX, Anne, Mokey, Samer"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://mmox.me/posts/writeups/cyctf2025-qual-official-writeup/"},"publisher":{"@type":"Organization","name":"MMOX Blog","logo":{"@type":"ImageObject","url":"https://mmox.me/img/Favicon.webp"}}}</script></head><body id=top><script crossorigin=anonymous src=/assets/js/theme.b20f95bb4da41ef90a2610a557a7000b2649a3f47282ec571676da6fc0427200.js integrity="sha256-sg+Vu02kHvkKJhClV6cACyZJo/RyguxXFnbab8BCcgA="></script><header class=header><div id=progressBar></div><nav class=nav><div class=logo><a href=https://mmox.me/ accesskey=h title="MMOX (Alt + H)">MMOX</a>
<button type=button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><input name=hamburger-input id=hamburger-input type=checkbox aria-label="Navigation Menu">
<label id=hamburger-menu for=hamburger-input></label><div class=overlay></div><ul id=menu><li><a href=https://mmox.me/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://mmox.me/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://mmox.me/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://mmox.me/mylabs/ title=MyLabs><span>MyLabs</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://mmox.me/>Home</a>&nbsp;»&nbsp;<a href=https://mmox.me/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">CyCTF2025 Qual DFIR Official writeup</h1><div class=post-description>CyCTF2025 Qual DFIR Official writeup</div><div class=post-meta><span title='2025-11-08 00:00:00 +0000 UTC'>November 8, 2025</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;MMOX, Anne, Mokey, Samer</div><div class=post-meta></div></header><div class="toc side"><details id=toc><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#dokdok aria-label=DokDok>DokDok</a><ul><li><a href=#challenge-overview aria-label="Challenge Overview">Challenge Overview</a></li><li><a href=#scenario aria-label=Scenario>Scenario</a></li></ul></li><li><a href=#walkthrough aria-label=Walkthrough>Walkthrough</a><ul><ul><li><a href=#step-1--pull-the-image aria-label="Step 1 – Pull the image">Step 1 – Pull the image</a></li><li><a href=#step-2--save-the-image-to-a-tar-file aria-label="Step 2 – Save the image to a .tar file">Step 2 – Save the image to a .tar file</a></li><li><a href=#inspecting-image-layers aria-label="Inspecting image layers">Inspecting image layers</a></li></ul></ul></li><li><a href=#hidden-in-plain-sight aria-label="Hidden In Plain Sight">Hidden In Plain Sight</a><ul><li><a href=#challenge-overview-1 aria-label="Challenge Overview">Challenge Overview</a></li><li><a href=#scenario-1 aria-label=Scenario>Scenario</a></li></ul></li><li><a href=#walkthrough-1 aria-label=Walkthrough>Walkthrough</a><ul><li><a href=#1-evidence-of-filefolder-opening aria-label="1) Evidence of file/folder opening">1) Evidence of file/folder opening</a></li><li><a href=#2-evidence-of-execution aria-label="2) Evidence of execution">2) Evidence of execution</a></li><li><a href=#3-persistence aria-label="3) Persistence">3) Persistence</a></li><li><a href=#4-parsing-wmi-flag--part-1 aria-label="4) Parsing WMI (Flag — part 1)">4) Parsing WMI (Flag — part 1)</a><ul><li><a href=#tool-installation--usage aria-label="Tool installation / usage">Tool installation / usage</a></li><li><a href=#tool-in-action aria-label="Tool in action">Tool in action</a></li></ul></li><li><a href=#5-data-exfiltration-flag--part-2 aria-label="5) Data exfiltration (Flag — part 2)">5) Data exfiltration (Flag — part 2)</a></li><li><a href=#final-flag aria-label="Final flag">Final flag</a></li></ul></li><li><a href=#corrupted aria-label=Corrupted>Corrupted</a><ul><li><a href=#challenge-overview-2 aria-label="Challenge Overview">Challenge Overview</a></li><li><a href=#story aria-label=Story>Story</a></li><li><a href=#challenge-discovery aria-label="Challenge discovery">Challenge discovery</a></li><li><a href=#volatility-mission aria-label="Volatility mission">Volatility mission</a></li><li><a href=#but-we-cant-use-volatility-shell-to-work-with-the-internals-because-the-dump-is-corrupted-the-only-way-for-us-is-to-use-a-hex-editor aria-label="but we can&rsquo;t use volatility shell to work with the internals because the dump is corrupted, the only way for us is to use a hex-editor.">but we can&rsquo;t use volatility shell to work with the internals because the dump is corrupted, the only way for us is to use a hex-editor.</a></li></ul></li><li><a href=#walk-through-internals aria-label="Walk through internals">Walk through internals</a><ul><li><a href=#kernel-version aria-label="kernel version">kernel version</a></li><li><a href=#peb aria-label=Peb>Peb</a><ul><li><a href=#vtop aria-label=VtoP>VtoP</a></li></ul></li><li><a href=#get-heap aria-label="get heap">get heap</a></li></ul></li><li><a href=#get-flag aria-label="get flag">get flag</a></li><li><a href=#resources aria-label=resources>resources</a></li><li><a href=#trust-leak aria-label="Trust Leak">Trust Leak</a></li><li><a href=#i-am-so-tired-so-maybe-i-will-write-it-soon aria-label="I am so tired so maybe i will write it soon">I am so tired so maybe i will write it soon</a></li></ul></div></details></div><div class=post-content><h1 id=dokdok>DokDok<a hidden class=anchor aria-hidden=true href=#dokdok>#</a></h1><h2 id=challenge-overview>Challenge Overview<a hidden class=anchor aria-hidden=true href=#challenge-overview>#</a></h2><p><strong>Name:</strong> DokDok<br><strong>Level:</strong> Easy<br><strong>Link:</strong> <code>docker pull mmox/dokdok</code></p><h2 id=scenario>Scenario<a hidden class=anchor aria-hidden=true href=#scenario>#</a></h2><p>A CyAPT group abused a public Docker image to stage a quick web deployment and drop a memory-resident miner. The attacker attempted to cover their tracks by removing the payload after installation. Your job is to recover evidence from the image layers and answer three questions:</p><ol><li>Attacker wallet address (Ethereum-style <code>0x...</code>)</li><li>Cryptocurrency balance remaining in that wallet</li><li>Malware group name (APT name)</li></ol><p><strong>Flag format:</strong><br><code>CyCTF{wallet_balance_name}</code></p><hr><h1 id=walkthrough>Walkthrough<a hidden class=anchor aria-hidden=true href=#walkthrough>#</a></h1><h3 id=step-1--pull-the-image>Step 1 – Pull the image<a hidden class=anchor aria-hidden=true href=#step-1--pull-the-image>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker pull mmox/dokdok
</span></span></code></pre></div><h3 id=step-2--save-the-image-to-a-tar-file>Step 2 – Save the image to a <code>.tar</code> file<a hidden class=anchor aria-hidden=true href=#step-2--save-the-image-to-a-tar-file>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker save mmox/dokdok -o dokdok.tar
</span></span></code></pre></div><p>This exports the Docker image to a tar archive (<code>dokdok.tar</code>), allowing offline transfer and analysis.</p><h3 id=inspecting-image-layers>Inspecting image layers<a hidden class=anchor aria-hidden=true href=#inspecting-image-layers>#</a></h3><p>By unarchiving the image layers you will find a file named <code>IMPORTANT</code> inside the layer with ID <code>af89492eb8f755a7d12c55b850e792bc2acaf1640ba7eb2b6cf6aae74e44600f</code>.</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/d1.png alt="Important file found"></p><p>A quick <code>strings</code> check shows the file is UPX-packed.</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/d2.png alt="UPX detected"></p><p>Unpack the binary:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>upx -d IMPORTANT
</span></span></code></pre></div><p><img loading=lazy src=/postImgs/CyCTF25Quals/d3.png alt="UPX unpacked"></p><p>A short reverse engineering step reveals a function that decodes the wallet address:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>_BYTE</span> <span class=o>*</span><span class=nf>decode_wallet_internal</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>_BYTE</span> <span class=o>*</span><span class=n>v1</span><span class=p>;</span> <span class=c1>// [rsp+0h] [rbp-10h]
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>unsigned</span> <span class=kr>__int64</span> <span class=n>i</span><span class=p>;</span> <span class=c1>// [rsp+8h] [rbp-8h]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>v1</span> <span class=o>=</span> <span class=nf>malloc</span><span class=p>(</span><span class=mh>0x2BuLL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span> <span class=o>!</span><span class=n>v1</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0LL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0LL</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mh>0x2A</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>v1</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>XOR_KEY</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=mh>0xB</span><span class=p>]</span> <span class=o>^</span> <span class=n>OBF_WALLET</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>v1</span><span class=p>[</span><span class=mi>42</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>v1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This function XORs the wallet address with an XOR key; both the key and the obfuscated wallet are stored in the data sections.</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/d5.png alt="Code snippet"><br><img loading=lazy src=/postImgs/CyCTF25Quals/d4.png alt="Data section"></p><p>After XOR-decoding, you obtain the wallet address:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0x460ab1c34e4388704c5e56e18D904Ed117D077CC
</span></span></code></pre></div><p>To get the balance, search the wallet on Ethplorer (or a similar blockchain explorer):</p><p><code>https://ethplorer.io/address/0x460ab1c34e4388704c5e56e18d904ed117d077cc#</code></p><p><img loading=lazy src=/postImgs/CyCTF25Quals/d6.png alt="Ethplorer snapshot"></p><p><strong>Balance found:</strong><br><code>0.08784870748313268</code></p><p>For the APT name, a quick web search of the wallet shows the group name in the first result:</p><p><strong>APT name:</strong> <code>Lazarus</code></p><p><strong>Final flag:</strong><br><code>CyCTF{0x460ab1c34e4388704c5e56e18D904Ed117D077CC_0.08784870748313268_Lazarus}</code></p><hr><h1 id=hidden-in-plain-sight>Hidden In Plain Sight<a hidden class=anchor aria-hidden=true href=#hidden-in-plain-sight>#</a></h1><h2 id=challenge-overview-1>Challenge Overview<a hidden class=anchor aria-hidden=true href=#challenge-overview-1>#</a></h2><p><strong>Name:</strong> HiddenInPlainSight<br><strong>Level:</strong> Medium<br><strong>Files:</strong> <code>HiddenInPlain.zip</code><br><strong>File password:</strong> <code>CyCTF2025#DFIR</code><br><strong>SHA256:</strong> <code>2420cc73d3d7be32af405929cee38bb818eaa06f48c50931c785937a7b15f9ae</code><br><strong>Link:</strong> <a href="https://drive.google.com/file/d/14vUE4x_rX1l4TzjNYFpSzwJQswxT1mYZ/view?usp=drive_link">Download challenge</a></p><h2 id=scenario-1>Scenario<a hidden class=anchor aria-hidden=true href=#scenario-1>#</a></h2><p>An HR staff member received a phishing email from an attacker posing as an HR colleague requesting a résumé review. The user downloaded a malicious PDF that resulted in system compromise.</p><p><strong>Task:</strong> identify red flags and recover the two-part flag: <code>CyCTF{part1_part2}</code></p><hr><h1 id=walkthrough-1>Walkthrough<a hidden class=anchor aria-hidden=true href=#walkthrough-1>#</a></h1><h2 id=1-evidence-of-filefolder-opening>1) Evidence of file/folder opening<a hidden class=anchor aria-hidden=true href=#1-evidence-of-filefolder-opening>#</a></h2><p><code>.lnk</code> files and RecentDocs may <strong>not</strong> show the malicious PDF if the delivered file is actually an executable renamed as a PDF. However, we can detect the data staging folder:</p><ul><li><img loading=lazy src=/postImgs/CyCTF25Quals/h3.png alt="Data staging folder"></li><li><code>.lnk</code> evidence: <img loading=lazy src=/postImgs/CyCTF25Quals/h4.png alt="LNK evidence"></li></ul><hr><h2 id=2-evidence-of-execution>2) Evidence of execution<a hidden class=anchor aria-hidden=true href=#2-evidence-of-execution>#</a></h2><ul><li><p><code>Amcache</code> provided little useful information in this case.</p></li><li><p><code>Prefetch</code> shows evidence of execution of the malicious PDF/executable:</p><ul><li><img loading=lazy src=/postImgs/CyCTF25Quals/h5.png alt="Prefetch evidence"></li></ul></li></ul><hr><h2 id=3-persistence>3) Persistence<a hidden class=anchor aria-hidden=true href=#3-persistence>#</a></h2><p>A malicious scheduled task was discovered:</p><ul><li><img loading=lazy src=/postImgs/CyCTF25Quals/h6.png alt="Scheduled Task 1"></li><li><img loading=lazy src=/postImgs/CyCTF25Quals/h7.png alt="Scheduled Task 2"></li><li><img loading=lazy src=/postImgs/CyCTF25Quals/h8.png alt="Scheduled Task 3"></li></ul><p><strong>Analysis:</strong> the scheduled task executes a payload stored inside the WMI repository. The WMI entry is located at:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>Namespace</span><span class=p>:</span> <span class=n>root</span>\<span class=n>cimv2</span>
</span></span><span class=line><span class=cl><span class=n>ClassName</span><span class=p>:</span> <span class=n>windowsupdate</span>
</span></span><span class=line><span class=cl><span class=n>Filter</span><span class=p>:</span> <span class=n>Name</span><span class=o>=</span><span class=s2>&#34;MyHiddenPayload&#34;</span>
</span></span></code></pre></div><p>The payload is executed directly in memory.</p><hr><h2 id=4-parsing-wmi-flag--part-1>4) Parsing WMI (Flag — part 1)<a hidden class=anchor aria-hidden=true href=#4-parsing-wmi-flag--part-1>#</a></h2><p>The WMI repository data is not plain text (strings appear garbled). Use a WMI-parsing tool that can read the repository (for example, Mandiant’s <code>python-cim</code> sample tools):</p><p>Repository: <code>https://github.com/mandiant/flare-wmi/tree/master/python-cim/samples</code></p><h3 id=tool-installation--usage>Tool installation / usage<a hidden class=anchor aria-hidden=true href=#tool-installation--usage>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># clone the repo</span>
</span></span><span class=line><span class=cl>sudo git clone https://github.com/mandiant/flare-wmi.git
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># install python venv</span>
</span></span><span class=line><span class=cl>sudo apt install python3-venv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># inside the repo, create the venv</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> flare-wmi
</span></span><span class=line><span class=cl>python3 -m venv venv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># activate it (do not use sudo when activating)</span>
</span></span><span class=line><span class=cl><span class=nb>source</span> venv/bin/activate
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># install library dependencies in the virtualenv</span>
</span></span><span class=line><span class=cl>env/bin/pip install python-cim
</span></span><span class=line><span class=cl>env/bin/pip install construct tqdm
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># timeline example</span>
</span></span><span class=line><span class=cl>python3 timeline.py <span class=o>[</span>repo path<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># dump class instance</span>
</span></span><span class=line><span class=cl>python3 dump_class_instance.py win7 <span class=s2>&#34;repo_path&#34;</span> <span class=s2>&#34;namespace&#34;</span> <span class=s2>&#34;classname&#34;</span>
</span></span></code></pre></div><blockquote><p>Note: the <code>python-cim</code> package in PyPI may be outdated; you may need to use the provided GitHub scripts to avoid errors.</p></blockquote><h3 id=tool-in-action>Tool in action<a hidden class=anchor aria-hidden=true href=#tool-in-action>#</a></h3><ul><li><img loading=lazy src=/postImgs/CyCTF25Quals/h9.png alt="WMI parsing output"></li></ul><p><strong>Decoding details</strong></p><ul><li>Key: <code>0x45</code> (decimal <code>69</code>) — the stored array appears XOR-encoded.</li><li>The stored byte array (decimal) is:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>EncodedCommand=[36, 18, 19, 113, 12, 6, 45, 39, 16, 118, 41, 63, 33, 2, 19, 49, 9, 41, 23, 41, 32, 13, 20, 48, 23, 18, 112, 47, 39, 119, 23, 53, 39, 40, 33, 33, 10, 47, 53, 19, 19, 0, 28, 113, 9, 46, 33, 41, 33, 3, 11, 117, 38, 40, 41, 48, 31, 60, 34, 42, 36, 29, 33, 60, 12, 2, 45, 117, 33, 13, 4, 115, 9, 60, 124, 116, 38, 2, 23, 45, 33, 2, 19, 63, 9, 40, 116, 53, 28, 118, 15, 51, 38, 63, 7, 40, 33, 6, 112, 47, 39, 119, 117, 115, 10, 1, 4, 113, 8, 6, 124, 50, 28, 29, 15, 117, 8, 22, 124, 12, 8, 18, 20, 61, 39, 40, 38, 61, 39, 41, 7, 54, 28, 17, 3, 48, 20, 63, 3, 11, 16, 63, 3, 43, 36, 13, 20, 51, 31, 40, 41, 54, 31, 22, 112, 50, 38, 63, 0, 34, 9, 19, 19, 63, 31, 16, 15, 45, 38, 119, 41, 47, 16, 2, 3, 60, 38, 119, 41, 48, 31, 60, 46, 48, 20, 119, 124, 48, 33, 2, 19, 48, 33, 6, 46, 53]
</span></span></code></pre></div><p>Using a simple Python XOR decoder (XOR with <code>key=96</code> in this dataset — see the sample script), the decoded string (Part 1) is:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>H1d1ng1nPla1nC1MS1ght
</span></span></code></pre></div><ul><li><img loading=lazy src=/postImgs/CyCTF25Quals/h10.png alt="Decoded output / Flag part 1"></li></ul><hr><h2 id=5-data-exfiltration-flag--part-2>5) Data exfiltration (Flag — part 2)<a hidden class=anchor aria-hidden=true href=#5-data-exfiltration-flag--part-2>#</a></h2><p>The attacker used Background Intelligent Transfer Service (BITS) to exfiltrate the staged data.</p><p><strong>Findings:</strong></p><ul><li>BITS client logs (Job started events IDs 3 and 59) record the job name, the URL, and the file size, but they do <strong>not</strong> record the original staged file name.</li><li>Example evidence: <img loading=lazy src=/postImgs/CyCTF25Quals/h11.png alt="BITS log 1"></li></ul><p><strong>Part 2 (decoded / discovered):</strong> <code>ALittleBITSofData</code></p><hr><h2 id=final-flag>Final flag<a hidden class=anchor aria-hidden=true href=#final-flag>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>CyCTF{H1d1ng1nPla1nC1MS1ght_ALittleBITSofData}
</span></span></code></pre></div><hr><h1 id=corrupted>Corrupted<a hidden class=anchor aria-hidden=true href=#corrupted>#</a></h1><h2 id=challenge-overview-2>Challenge Overview<a hidden class=anchor aria-hidden=true href=#challenge-overview-2>#</a></h2><p><strong>Name:</strong> Corrupted<br><strong>Level:</strong> Hard<br><strong>Files:</strong> <code>corrupted.zip</code><br><strong>SHA256:</strong> <code>e3283de65cdc1be4634983540d732268e5431e0583cf0b35850659612dc2aa83</code><br><strong>Link:</strong> <a href="https://drive.google.com/file/d/16fGjUiL76tlYH7f_tO-Ffkn_QyNuZ-Ib/view?usp=drive_link">Download challenge</a></p><hr><p><img loading=lazy src=/postImgs/CyCTF25Quals/mem.gif alt=mem></p><h2 id=story>Story<a hidden class=anchor aria-hidden=true href=#story>#</a></h2><p>Our organization was hit by a sophisticated APT. During the incident we captured a memory dump, but the attacker corrupted the dump, wiped server traces, and halted operations.</p><p>Fortunately, an experimental tool salvaged page table fragments; these fragments may be the only clues left to identify the threat actor we call <strong>APT M</strong>.</p><p><strong>Mission:</strong> analyze the corrupted memory dump, recover evidence, and uncover the attacker.</p><blockquote><p>The technical objective is to demonstrate how to walk memory manually without relying on Volatility — for example, in cases where a brand-new Windows kernel version is not yet supported by existing tools.</p></blockquote><p>This challenge was inspired by <a href=https://www.linkedin.com/in/mohamed-labib-3bb381178/>Mohamed Labib</a>.</p><hr><h2 id=challenge-discovery>Challenge discovery<a hidden class=anchor aria-hidden=true href=#challenge-discovery>#</a></h2><p>After extracting <code>corrupted.zip</code>, you will find:</p><ul><li><code>corrupted</code> → the main memory dump</li><li><code>pagetable.backup</code> → a file containing partial page table entries</li></ul><p>The usual first step is to run Volatility on the dump.</p><hr><h2 id=volatility-mission>Volatility mission<a hidden class=anchor aria-hidden=true href=#volatility-mission>#</a></h2><p>I&rsquo;m using volatility 2 (Yes I am very old, i know) so I will start by getting the memory suggested profiles.</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m1.png alt=psscan></p><p>and it&rsquo;s windows 7 64 bit .</p><p>time to check running processes, using pslist plugin.</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m2.png alt=psscan></p><p>but , no thing found voltility couldent follow the KDOM double linked list to find the running processes.</p><p>The description said that the dump is corrupted, not encrypted, so if we could do a brute force search for the EPROCESS header bytes regardless of the pages we could find the present process on the system.</p><p>so psscan shold give us some output .</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m3.png alt=psscan></p><p>As expected, psscan did the mission.</p><p>and its clear from the process named <strong>FOLLOWMYHEAP</strong> that the flag is on its heap .</p><p>but where to find the process heap and heaps !</p><p>in process <strong>Peb</strong> structure we can find a pointer to process heap.[1]</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m4.png alt=psscan></p><p>and peb is part of <strong>EPROCESS</strong> struct .</p><h2 id=but-we-cant-use-volatility-shell-to-work-with-the-internals-because-the-dump-is-corrupted-the-only-way-for-us-is-to-use-a-hex-editor>but we can&rsquo;t use volatility shell to work with the internals because the dump is corrupted, the only way for us is to use a hex-editor.<a hidden class=anchor aria-hidden=true href=#but-we-cant-use-volatility-shell-to-work-with-the-internals-because-the-dump-is-corrupted-the-only-way-for-us-is-to-use-a-hex-editor>#</a></h2><h1 id=walk-through-internals>Walk through internals<a hidden class=anchor aria-hidden=true href=#walk-through-internals>#</a></h1><p>we will not start from point 0, because we got important information from psscan which is the physical address of the target process , which is <strong>0xf51fd50</strong></p><p>you can start by jumping to this location.</p><p>now we are standing on the start byte of the target eprocess struct.</p><h2 id=kernel-version>kernel version<a hidden class=anchor aria-hidden=true href=#kernel-version>#</a></h2><p>the next step we need to know the kenel verion of this mechine , we can do it in 2 wayes .</p><p>the first is to search for windows7 kernel verion.[2]</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m5.png alt=5></p><p>windows 7 version is 6.1 .</p><p>the second way is to use the process id and search for it in the struct, once you find its location you can search for which version PID will be in this position.</p><p>you will find that pid location is 0x180 , search for pid with location 0x180 in eprocess struct.[3]</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m6.png alt=6></p><p>we need to find the location of Peb in version 6.1.[4]</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m7.png alt=7></p><p>And peb location in process address space is 0x338 .</p><p>now we will jump to a Peb location &lt;process_physical address_location+Peb_location> which is <strong>0xf520088</strong></p><h2 id=peb>Peb<a hidden class=anchor aria-hidden=true href=#peb>#</a></h2><p>once we jump to the peb location , we will find the 8 byte pointer.</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m8.png alt=8></p><blockquote><p>Don&rsquo;t forget to swap the endianness</p></blockquote><p>pointer value is : <strong>0x40212220</strong></p><p>Peb pointer points to a virtual memory location so we need to get the physical memory address from this virtual memory.</p><h3 id=vtop>VtoP<a hidden class=anchor aria-hidden=true href=#vtop>#</a></h3><p>To calculate the physical memory from the virtual memory in a 64-bit system we need to parse the 64 pointer bits to page directory pointer, page directory, page table, page table entry, physical page offset.[5]</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m9.png alt=9></p><p>we can do it using a small python script</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=n>v_mem</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>bin_holder</span> <span class=o>=</span> <span class=p>(</span><span class=nb>bin</span><span class=p>(</span><span class=n>v_mem</span><span class=p>)[</span><span class=mi>2</span><span class=p>:])[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=nb>len</span><span class=p>(</span><span class=n>bin_holder</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>48</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>bin_holder</span> <span class=o>+=</span> <span class=s2>&#34;0&#34;</span> 
</span></span><span class=line><span class=cl><span class=n>Page_Offset</span> <span class=o>=</span> <span class=nb>hex</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>bin_holder</span><span class=p>[:</span><span class=mi>12</span><span class=p>][::</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>PTE</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>bin_holder</span><span class=p>[</span><span class=mi>12</span><span class=p>:</span><span class=mi>21</span><span class=p>][::</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>PT</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>bin_holder</span><span class=p>[</span><span class=mi>21</span><span class=p>:</span><span class=mi>30</span><span class=p>][::</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>PD</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>bin_holder</span><span class=p>[</span><span class=mi>30</span><span class=p>:</span><span class=mi>39</span><span class=p>][::</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>PDP</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>bin_holder</span><span class=p>[</span><span class=mi>39</span><span class=p>:][::</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;page directory pointer : &#34;</span> <span class=o>+</span> <span class=n>PDP</span> <span class=o>+</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>page directory : &#34;</span> <span class=o>+</span> <span class=n>PD</span> <span class=o>+</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>page table : &#34;</span> <span class=o>+</span> <span class=n>PT</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>page table entry : &#34;</span> <span class=o>+</span> <span class=n>PTE</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>physical page offset : &#34;</span> <span class=o>+</span> <span class=n>Page_Offset</span> <span class=p>)</span>
</span></span></code></pre></div><p>when we use the peb pointer as an input</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m10.png alt=10></p><p>we have all information to get the last part of the physical address, we just need to search the pagetable file using the page pointers we got from the script.</p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m11.png alt=11></p><p>now concatenate the number we got from the page table and the physical page offset to get the physical address.</p><p>the physical address of peb is <strong>0x2761220</strong></p><h2 id=get-heap>get heap<a hidden class=anchor aria-hidden=true href=#get-heap>#</a></h2><p>the last thing to do is to get the heap pointer from peb, once the description said process heap so we need only to jump to the heap pointer and no need to parse the heap&rsquo;s table pointer and go through each one.</p><p><strong>NOTE: heap is real memory will point to address in process address space, but here I modified the pointer to point to a physical address so you will not have to vtop again.</strong></p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m12.png alt=12></p><p>so we need to jump to <strong>0x2761250</strong></p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m13.png alt=13></p><p>the last jump will be to <strong>0x2c9220</strong></p><p><img loading=lazy src=/postImgs/CyCTF25Quals/m14.png alt=14></p><p>and not a completely bingooo , you just need to reorganize the flag.</p><h1 id=get-flag>get flag<a hidden class=anchor aria-hidden=true href=#get-flag>#</a></h1><p>collect the flag bytes and locations from the heap.</p><p>ues a scaript get the flag</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;GZXuV0SpzVDXmZl10pbRYMl1yR99QwI3INmezQMEyd7wdXFm&#39;</span>
</span></span><span class=line><span class=cl><span class=n>flo</span> <span class=o>=</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>34</span><span class=p>,</span> <span class=mi>46</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>22</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>42</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>14</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>26</span><span class=p>,</span> <span class=mi>28</span><span class=p>,</span> <span class=mi>37</span><span class=p>,</span> <span class=mi>43</span><span class=p>,</span> <span class=mi>41</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>32</span><span class=p>,</span> <span class=mi>27</span><span class=p>,</span> <span class=mi>19</span><span class=p>,</span> <span class=mi>48</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>36</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>38</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=mi>44</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>39</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>24</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=mi>33</span><span class=p>,</span> <span class=mi>47</span><span class=p>,</span> <span class=mi>30</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>newfl</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>flo</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>ind</span> <span class=o>=</span> <span class=n>flo</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>newfl</span> <span class=o>+=</span> <span class=n>flag</span><span class=p>[</span><span class=n>ind</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>newfl</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>newfl</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span></code></pre></div><p><img loading=lazy src=/postImgs/CyCTF25Quals/m15.png alt=15></p><p>congratulations <strong>KING</strong></p><h1 id=resources>resources<a hidden class=anchor aria-hidden=true href=#resources>#</a></h1><p><a href=https://www.nirsoft.net/kernel_struct/vista/PEB.html>1- PEB overview</a></p><p><a href=https://en.wikipedia.org/wiki/Comparison_of_Microsoft_Windows_versions>2- kernel version</a></p><p><a href=https://www.geoffchappell.com/studies/windows/km/ntoskrnl/inc/ntos/ps/eprocess/index.htm>3- Eprocess struct</a></p><p><a href=https://www.geoffchappell.com/studies/windows/km/ntoskrnl/inc/api/pebteb/peb/index.htm>4- PEB struct</a></p><p><a href=http://www.windowsscope.com/virtual-memory-and-address-translating-for-x64/>5- virtual memory to physical in win 64 bit</a></p><h1 id=trust-leak>Trust Leak<a hidden class=anchor aria-hidden=true href=#trust-leak>#</a></h1><h1 id=i-am-so-tired-so-maybe-i-will-write-it-soon>I am so tired so maybe i will write it soon<a hidden class=anchor aria-hidden=true href=#i-am-so-tired-so-maybe-i-will-write-it-soon>#</a></h1><p><img loading=lazy src=/postImgs/CyCTF25Quals/gg.gif alt=gg></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://mmox.me/tags/cyctf2025/>CyCTF2025</a></li><li><a href=https://mmox.me/tags/writeups/>Writeups</a></li><li><a href=https://mmox.me/tags/digital-forensics/>Digital Forensics</a></li><li><a href=https://mmox.me/tags/memory/>Memory</a></li><li><a href=https://mmox.me/tags/wmi/>WMI</a></li><li><a href=https://mmox.me/tags/docker-forensics/>Docker Forensics</a></li></ul><nav class=paginav><a class=prev href=https://mmox.me/posts/writeups/cyctf2022-writeup/><span class=title>« Prev</span><br><span>CyCTF 2022 Writeups</span>
</a><a class=next href=https://mmox.me/posts/dfir/dfir-and-soc-roadmap/><span class=title>Next »</span><br><span>DFIR & SOC - Roadmap (From Zero To Hero)</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share CyCTF2025 Qual DFIR Official writeup on x" href="https://x.com/intent/tweet/?text=CyCTF2025%20Qual%20DFIR%20Official%20writeup&amp;url=https%3a%2f%2fmmox.me%2fposts%2fwriteups%2fcyctf2025-qual-official-writeup%2f&amp;hashtags=CyCTF2025%2cWriteups%2cDigitalForensics%2cMemory%2cWMI%2cDockerForensics"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CyCTF2025 Qual DFIR Official writeup on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fmmox.me%2fposts%2fwriteups%2fcyctf2025-qual-official-writeup%2f&amp;title=CyCTF2025%20Qual%20DFIR%20Official%20writeup&amp;summary=CyCTF2025%20Qual%20DFIR%20Official%20writeup&amp;source=https%3a%2f%2fmmox.me%2fposts%2fwriteups%2fcyctf2025-qual-official-writeup%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CyCTF2025 Qual DFIR Official writeup on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fmmox.me%2fposts%2fwriteups%2fcyctf2025-qual-official-writeup%2f&title=CyCTF2025%20Qual%20DFIR%20Official%20writeup"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CyCTF2025 Qual DFIR Official writeup on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fmmox.me%2fposts%2fwriteups%2fcyctf2025-qual-official-writeup%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CyCTF2025 Qual DFIR Official writeup on whatsapp" href="https://api.whatsapp.com/send?text=CyCTF2025%20Qual%20DFIR%20Official%20writeup%20-%20https%3a%2f%2fmmox.me%2fposts%2fwriteups%2fcyctf2025-qual-official-writeup%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CyCTF2025 Qual DFIR Official writeup on telegram" href="https://telegram.me/share/url?text=CyCTF2025%20Qual%20DFIR%20Official%20writeup&amp;url=https%3a%2f%2fmmox.me%2fposts%2fwriteups%2fcyctf2025-qual-official-writeup%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CyCTF2025 Qual DFIR Official writeup on ycombinator" href="https://news.ycombinator.com/submitlink?t=CyCTF2025%20Qual%20DFIR%20Official%20writeup&u=https%3a%2f%2fmmox.me%2fposts%2fwriteups%2fcyctf2025-qual-official-writeup%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><html></html></article></main><footer class=footer><span>&copy; 2025 <a href=https://mmox.me/>MMOX Blog</a></span>
<span>- Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer">Hugo</a> &
        <a href=https://github.com/Wonderfall/hugo-WonderMod/ rel=noopener>WonderMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script defer crossorigin=anonymous src=/assets/js/papermod.7ea300eda6d3653624a576fbc095ccd8a0c2977756acbe5de4114132a72cc7fa.js integrity="sha256-fqMA7abTZTYkpXb7wJXM2KDCl3dWrL5d5BFBMqcsx/o="></script></body></html>